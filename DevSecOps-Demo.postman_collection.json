{
  "info": {
    "name": "DevSecOps Demo - Security Testing",
    "description": "Colecci√≥n de Postman para demostrar seguridad integrada en DevSecOps",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "üìã Informaci√≥n General",
      "item": [
        {
          "name": "1. Home - Features de Seguridad",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": [""]
            },
            "description": "Muestra todas las caracter√≠sticas de seguridad implementadas en la aplicaci√≥n"
          },
          "response": []
        },
        {
          "name": "2. Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/health",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["health"]
            },
            "description": "Health check con informaci√≥n de seguridad habilitada"
          },
          "response": []
        },
        {
          "name": "3. Informaci√≥n de Seguridad",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/api/security-info",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "security-info"]
            },
            "description": "Muestra todas las medidas de seguridad implementadas y compliance (OWASP Top 10, PCI-DSS, GDPR)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üîê Autenticaci√≥n",
      "item": [
        {
          "name": "4. Login Exitoso",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Guardar el token autom√°ticamente",
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set(\"jwt_token\", jsonData.token);",
                  "    pm.test(\"Token guardado correctamente\", function () {",
                  "        pm.expect(jsonData.token).to.be.a('string');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"Admin123!\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/api/login",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "login"]
            },
            "description": "Login con credenciales correctas. El token JWT se guarda autom√°ticamente.\n\n‚úÖ Credenciales v√°lidas:\n- Username: admin\n- Password: Admin123!"
          },
          "response": []
        },
        {
          "name": "5. Login - Credenciales Incorrectas",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"wrongpassword\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/api/login",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "login"]
            },
            "description": "‚ùå Demostraci√≥n de seguridad: Login con password incorrecta\n\nEspera un error 401 - Credenciales inv√°lidas"
          },
          "response": []
        },
        {
          "name": "6. Login - Username muy corto",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"ab\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/api/login",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "login"]
            },
            "description": "‚ùå Demostraci√≥n de validaci√≥n de entrada\n\nUsername debe tener entre 3 y 30 caracteres.\nEspera un error 400 - Bad Request"
          },
          "response": []
        },
        {
          "name": "7. Login - Password muy corta",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"12345\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/api/login",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "login"]
            },
            "description": "‚ùå Demostraci√≥n de validaci√≥n de entrada\n\nPassword debe tener m√≠nimo 6 caracteres.\nEspera un error 400 - Bad Request"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üîí Rutas Protegidas",
      "item": [
        {
          "name": "8. Acceso SIN Token (DEBE FALLAR)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/api/secure/profile",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "secure", "profile"]
            },
            "description": "‚ùå Demostraci√≥n de autorizaci√≥n\n\nIntentar acceder sin token debe fallar.\nEspera un error 401 - Token no proporcionado\n\n‚ö†Ô∏è ESTO ES LO ESPERADO - muestra que la seguridad funciona"
          },
          "response": []
        },
        {
          "name": "9. Acceso con Token Inv√°lido (DEBE FALLAR)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer token-invalido-123",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/api/secure/profile",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "secure", "profile"]
            },
            "description": "‚ùå Demostraci√≥n de validaci√≥n de token\n\nToken inv√°lido debe ser rechazado.\nEspera un error 403 - Token inv√°lido o expirado"
          },
          "response": []
        },
        {
          "name": "10. Acceso CON Token V√°lido (DEBE FUNCIONAR)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:3000/api/secure/profile",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "secure", "profile"]
            },
            "description": "‚úÖ Acceso autorizado con token JWT v√°lido\n\nUsa el token guardado del login.\nMuestra el perfil del usuario autenticado.\n\nüí° Ejecuta primero el request '4. Login Exitoso' para obtener el token"
          },
          "response": []
        },
        {
          "name": "11. Enviar Datos Seguros CON Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"data\": \"Datos importantes de la empresa\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/api/secure/data",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "secure", "data"]
            },
            "description": "‚úÖ Env√≠o de datos con validaci√≥n y autorizaci√≥n\n\nLos datos son sanitizados antes de procesarse.\n\nüí° Requiere token JWT v√°lido"
          },
          "response": []
        },
        {
          "name": "12. Datos Vac√≠os - Validaci√≥n (DEBE FALLAR)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"data\": \"\"\n}"
            },
            "url": {
              "raw": "http://localhost:3000/api/secure/data",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "secure", "data"]
            },
            "description": "‚ùå Demostraci√≥n de validaci√≥n de entrada\n\nDatos vac√≠os no deben ser aceptados.\nEspera un error 400 - Validaci√≥n fallida"
          },
          "response": []
        }
      ]
    },
    {
      "name": "‚ö° Rate Limiting",
      "item": [
        {
          "name": "13. Test Rate Limiting - Request 1",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/api/security-info",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["api", "security-info"]
            },
            "description": "Ejecuta este request m√∫ltiples veces r√°pidamente para probar el rate limiting.\n\nDespu√©s de 100 requests en 15 minutos, el servidor bloquear√° las peticiones."
          },
          "response": []
        }
      ]
    },
    {
      "name": "üö´ Manejo de Errores",
      "item": [
        {
          "name": "14. Ruta No Existente - 404",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/ruta-que-no-existe",
              "protocol": "http",
              "host": ["localhost"],
              "port": "3000",
              "path": ["ruta-que-no-existe"]
            },
            "description": "Demostraci√≥n de manejo seguro de errores.\n\nEspera un error 404 - Ruta no encontrada\n\nNota: El mensaje de error no expone informaci√≥n sensible del sistema."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "jwt_token",
      "value": "",
      "type": "string"
    }
  ]
}
